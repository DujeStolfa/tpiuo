name: Docker Image CI - consumer

on:
  push:
    branches: 
      - "main"
    paths: 
      - '**.py'
jobs:
  editorconfig:
    runs-on: ubuntu-latest
  
    steps:
    - name: EditorConfig-Action
      uses: zbeekman/EditorConfig-Action@v1.1.1

  lint:
    runs-on: ubuntu-latest

    steps:
    - name: Super-Linter
      uses: super-linter/super-linter@v5.7.2

  build:
    needs: [editorconfig, lint]
    runs-on: ubuntu-latest

    steps:
    - name: Log in to Azure
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    
    - name: Azure Container Apps Build and Deploy
      uses: Azure/container-apps-deploy-action@v2
      with:
        containerAppName: consumer
        resourceGroup: fervjestina
        imageToDeploy: lab_2/consumer/Dockerfile
        acrName: oblakcontainer
        
        
